# ⚡ أوامر التشغيل السريعة - نظام كشف السرعة بالرادار

## 🚀 التشغيل السريع (للجهاز الحالي)

### تشغيل النظام كاملاً:
```bash
cd ~/Desktop/radar_sys/potassium-frontend
./start-all-systems.sh
```

### إيقاف النظام:
```bash
cd ~/Desktop/radar_sys/potassium-frontend
./stop-all-systems.sh
```

---

## 🔧 للجهاز الجديد - خطوات التثبيت

### 1. المتطلبات الأساسية:
```bash
# تحقق من Node.js
node --version  # يجب أن يكون 16+ 
npm --version   # يجب أن يكون 8+

# إذا لم يكن مثبتاً:
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs
```

### 2. استنساخ المشروع:
```bash
# إنشاء مجلد المشروع
mkdir -p ~/Desktop/radar_system
cd ~/Desktop/radar_system

# استنساخ المستودعات (استبدل بالروابط الصحيحة)
git clone https://github.com/yourusername/potassium-frontend.git
git clone https://github.com/yourusername/potassium-backend-.git
```

### 3. تثبيت التبعيات:
```bash
# الواجهة الأمامية
cd ~/Desktop/radar_system/potassium-frontend
npm install

# الواجهة الخلفية
cd ~/Desktop/radar_system/potassium-backend-
npm install
```

### 4. إعداد قاعدة البيانات:
```bash
# تسجيل الدخول لـ MySQL
sudo mysql -u root -p

# تنفيذ الأوامر التالية في MySQL:
```
```sql
CREATE DATABASE potassium_radar;
CREATE USER 'radar_user'@'localhost' IDENTIFIED BY 'StrongPassword123!';
GRANT ALL PRIVILEGES ON potassium_radar.* TO 'radar_user'@'localhost';
FLUSH PRIVILEGES;
EXIT;
```

### 5. إنشاء ملفات البيئة:

#### للواجهة الخلفية:
```bash
cd ~/Desktop/radar_system/potassium-backend-
nano .env
```
أضف:
```env
DB_HOST=localhost
DB_PORT=3306
DB_NAME=potassium_radar
DB_USER=radar_user
DB_PASSWORD=StrongPassword123!
PORT=3000
NODE_ENV=development
FTP_HOST=192.168.1.55
FTP_PORT=21
FTP_USERNAME=camera001
FTP_PASSWORD=RadarCamera01
```

#### للواجهة الأمامية:
```bash
cd ~/Desktop/radar_system/potassium-frontend
nano .env
```
أضف:
```env
REACT_APP_API_URL=http://localhost:3000/api
REACT_APP_FTP_SERVER_URL=http://localhost:3003
PORT=3002
BROWSER=none
```

### 6. تحديث المسارات:
```bash
cd ~/Desktop/radar_system/potassium-frontend
nano start-all-systems.sh
```
غير:
```bash
BACKEND_DIR="/home/YOUR_USERNAME/Desktop/radar_system/potassium-backend-"
FRONTEND_DIR="/home/YOUR_USERNAME/Desktop/radar_system/potassium-frontend"
```

### 7. تشغيل النظام:
```bash
chmod +x start-all-systems.sh
chmod +x stop-all-systems.sh
./start-all-systems.sh
```

---

## 🌐 عناوين الوصول

بعد التشغيل الناجح:
- **الواجهة الرئيسية**: http://localhost:3002
- **API الخلفية**: http://localhost:3000
- **خادم الصور**: http://localhost:3003

### بيانات تسجيل الدخول:
```
👤 المدير:
   البريد: admin@potasfactory.com
   كلمة المرور: admin123

👤 المشغل:
   البريد: operator@potasfactory.com
   كلمة المرور: operator123
```

---

## 🔍 فحص حالة النظام

### فحص الخدمات:
```bash
# فحص المنافذ
lsof -i :3000  # الواجهة الخلفية
lsof -i :3002  # الواجهة الأمامية  
lsof -i :3003  # خادم الصور

# فحص العمليات
ps aux | grep node
```

### فحص FTP:
```bash
curl http://localhost:3003/health
# يجب أن يظهر: {"ftp":{"connected":true}}
```

### فحص قاعدة البيانات:
```bash
mysql -u radar_user -p potassium_radar -e "SHOW TABLES;"
```

---

## 🛠️ استكشاف الأخطاء

### إذا فشل تشغيل الواجهة الخلفية:
```bash
cd ~/Desktop/radar_system/potassium-backend-
npm start
# راجع رسائل الخطأ وتأكد من إعدادات قاعدة البيانات
```

### إذا فشل FTP:
```bash
# تحقق من إعدادات FTP في:
nano ~/Desktop/radar_system/potassium-frontend/ftp-config.js
```

### إذا لم تظهر الصور:
```bash
# تحقق من مجلد الصور
ls -la /srv/camera_uploads/
# أو المجلد المحلي
ls -la ~/Desktop/radar_system/potassium-frontend/local-images/
```

### فحص السجلات:
```bash
# سجلات النظام
tail -f ~/Desktop/radar_system/potassium-frontend/backend_server.log
tail -f ~/Desktop/radar_system/potassium-frontend/frontend_dashboard.log
```

---

## ⚙️ تخصيص الإعدادات

### تغيير إعدادات FTP:
```bash
nano ~/Desktop/radar_system/potassium-frontend/ftp-config.js
```
عدل:
```javascript
const FTP_SERVER = {
  host: 'YOUR_FTP_IP',        // عنوان FTP الجديد
  username: 'YOUR_USERNAME',  // اسم المستخدم الجديد
  password: 'YOUR_PASSWORD'   // كلمة المرور الجديدة
};
```

### تغيير منافذ الخوادم:
```bash
# في ملف ftp-config.js
const SERVERS = {
  backend: { port: 3000 },     # منفذ الواجهة الخلفية
  frontend: { port: 3002 },    # منفذ الواجهة الأمامية
  imageServer: { port: 3003 }  # منفذ خادم الصور
};
```

---

## 🔄 أوامر الصيانة

### إعادة تشغيل الخدمات:
```bash
./stop-all-systems.sh
sleep 5
./start-all-systems.sh
```

### تحديث التبعيات:
```bash
# الواجهة الأمامية
cd ~/Desktop/radar_system/potassium-frontend
npm update

# الواجهة الخلفية  
cd ~/Desktop/radar_system/potassium-backend-
npm update
```

### نسخ احتياطي لقاعدة البيانات:
```bash
mysqldump -u radar_user -p potassium_radar > backup_$(date +%Y%m%d_%H%M%S).sql
```

### تنظيف الملفات المؤقتة:
```bash
# حذف ملفات السجل القديمة
find . -name "*.log" -mtime +7 -delete

# تنظيف cache npm
npm cache clean --force
```

---

## 📊 مراقبة الأداء

### مراقبة الموارد:
```bash
# استخدام المعالج والذاكرة
htop

# مساحة القرص
df -h

# حالة الشبكة
netstat -tulpn | grep :300
```

### مراقبة السجلات المباشرة:
```bash
# مراقبة جميع السجلات
tail -f *.log

# مراقبة سجل محدد
tail -f backend_server.log
```

---

## 🚨 أوامر الطوارئ

### إيقاف فوري لجميع الخدمات:
```bash
pkill -f "node.*potassium"
pkill -f "npm.*start"
```

### إعادة تشغيل MySQL:
```bash
sudo systemctl restart mysql
```

### فحص المنافذ المستخدمة:
```bash
sudo netstat -tulpn | grep LISTEN
```

### تحرير منفذ مستخدم:
```bash
# العثور على العملية
lsof -i :3000

# إيقاف العملية (استبدل PID)
kill -9 PID_NUMBER
```

---

## ✅ قائمة التحقق السريعة

قبل التشغيل، تأكد من:
- [ ] تم تثبيت Node.js (16+)
- [ ] تم تثبيت MySQL
- [ ] تم إنشاء قاعدة البيانات
- [ ] تم إنشاء ملفات .env
- [ ] تم تحديث المسارات في start-all-systems.sh
- [ ] تم تثبيت جميع التبعيات (npm install)
- [ ] تم إعطاء صلاحيات التنفيذ للسكريبتات

---

**🎉 بعد تطبيق هذه الخطوات، سيعمل النظام بشكل صحيح على أي جهاز جديد!**

**للوصول**: http://localhost:3002  
**تسجيل الدخول**: admin@potasfactory.com / admin123
